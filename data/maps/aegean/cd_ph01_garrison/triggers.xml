<?xml version="1.0" encoding="windows-1251" standalone="yes" ?>
<triggers>
	<trigger Name="GlobalVar" active="1">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			g_ObjCont:SetGameTime( gMissionTime[1], gMissionTime[2], gMissionTime[3], gMissionTime[4], gMissionTime[5] )
			
			SetWeather(0)

			ShowMap()

			Radar:SetScanRadius(800)

			GetPlayerVehicle():setImmortalMode(1)
			GetPlayerVehicle():SetNameFromScript("MyCar")
			SetCameraBehindPlayerVehicle()
			TActivate("PlayerDead")
			
			local friendly = {}
			local enemy = {}
			--                {objName                  Type               Prototype      EffHP VehHP FP Maneuv.      FriendlyName}
			friendly[1] = {"CDDestroyer01_vehicle_0", "CDDestroyerAegean", "CDPH01_DestroyerCD01", 1600, 1600, 9579, 22, "«Сеута» (э.м.т. «Альбедо»)"}
			friendly[2] = {"CDDestroyer02_vehicle_0", "CDDestroyerAegean", "CDPH01_DestroyerCD02", 1600, 1600, 7247, 22, "«Мелилья» (э.м.т. «Альбедо»)"}
			friendly[3] = {"CDMerchant01_vehicle_0", "CDMerchantAegean", "CDPH01_MerchantCD01", 163, 1500, 0, 4, "сухогруз «Августин Брейн»"}
			friendly[4] = {"CDMerchant02_vehicle_0", "CDMerchantAegean", "CDPH01_MerchantCD02", 163, 1500, 0, 4, "сухогруз «Хуан Эль-Уэво»"}
			--                {objName      EffHP VehHP FP Maneuv.}
			enemy[1] = {"CITDestroyer01_vehicle_0", 1200, 1200, 6958, 26}
			enemy[2] = {"CITDestroyer02_vehicle_0", 1200, 1200, 9758, 30}
			enemy[3] = {"CITDestroyer03_vehicle_0", 1200, 1200, 9758, 30}
			enemy[4] = {"CITDestroyer04_vehicle_0", 1200, 1200, 6958, 26}
			enemy[5] = {"CITTorpedoBoat01_vehicle_0", 39, 300, 729, 80}
			enemy[6] = {"CITTorpedoBoat02_vehicle_0", 39, 300, 954, 80}
			enemy[7] = {"CITTorpedoBoat03_vehicle_0", 39, 300, 729, 80}
			enemy[8] = {"CITTorpedoBoat04_vehicle_0", 39, 300, 954, 80}
			enemy[9] = {"CITBoat01_vehicle_0", 33, 125, 623, 55}
			enemy[10] = {"CITBoat02_vehicle_0", 33, 125, 623, 55}
			enemy[11] = {"CITBoat03_vehicle_0", 33, 125, 623, 55}
			enemy[12] = {"CITBoat04_vehicle_0", 33, 125, 623, 55}
			enemy[13] = {"CITBoat05_vehicle_0", 33, 125, 623, 55}
			enemy[14] = {"CITLav01_vehicle_0", 20, 300, 694, 0}
			enemy[15] = {"CITLav02_vehicle_0", 20, 300, 694, 0}
			enemy[16] = {"CITLav03_vehicle_0", 20, 300, 694, 0}
			enemy[17] = {"CITLav04_vehicle_0", 20, 300, 694, 0}
			enemy[18] = {"CITLav05_vehicle_0", 20, 300, 694, 0}
			enemy[19] = {"CITOldCruiser01_vehicle_0", 2000, 2000, 8292, 18}
			enemy[20] = {"CITDestroyer05_vehicle_0", 1200, 1200, 9758, 30}
			enemy[21] = {"CITOldCruiser02_vehicle_0", 2000, 2000, 11427, 20}
			enemy[22] = {"CITOldCruiser03_vehicle_0", 2000, 2000, 8423, 18}
			enemy[23] = {"CITHelicopter01_vehicle_0", 20, 500, 2864, 110}
			enemy[24] = {"CITHelicopter02_vehicle_0", 20, 500, 2864, 110}
			enemy[25] = {"CITHelicopter03_vehicle_0", 20, 500, 2864, 110}
			enemy[26] = {"CITHelicopter04_vehicle_0", 20, 500, 2864, 110}
			enemy[27] = {"CITCoastalGun01", 195, 17500, 3089, 0}
			enemy[28] = {"CITCoastalGun02", 195, 17500, 3089, 0}
			enemy[29] = {"CITCoastalGun03", 195, 17500, 3089, 0}
			enemy[30] = {"CITCoastalGun04", 195, 17500, 3089, 0}
			enemy[31] = {"CITAAGun01", 65, 3000, 629, 0}
			enemy[32] = {"CITAAGun02", 65, 3000, 629, 0}
			enemy[33] = {"CITAAGun03", 65, 3000, 629, 0}
			enemy[34] = {"CITAAGun04", 65, 3000, 629, 0}
			enemy[35] = {"CITAAGun05", 65, 3000, 629, 0}
			enemy[36] = {"CITAAGun06", 65, 3000, 629, 0}

			 

			SetVar("MissionTime", 0)
			SetVar("RequiredMissionTime", 904) -- mission completion time (in s) for getting bonus score
			SetVar("BaseRetreatScore", 20) -- base retreat score that may get multiplied depending on 4 different factors
			SetVar("RequiredRetreatScore", 30) -- retreat score that needs to be reached for each friendly unit to successfully retreat
			SetVar("PlayerHealth", 1600)
			SetVar("PlayerVehicleHealth", 1600)
			SetVar("PlayerEndHealth", GetVar("PlayerHealth").AsInt)
			SetVar("PlayerName", "«Абогадо» (э.м.т. «Альбедо»)")
			SetVar("Objectives", 3) -- amount of main objectives, excluding destruction of all enemy units and completing the mission without losses
			SetVar("ObjectiveScoreReward", 50000) -- how much score each objective gives
			SetVar("MissionScoreRewardMultiplier", 0.125) -- multiplier that determines how much money the player will receive for each score point

			local j = 1
			local friendlies = {}
			while friendly[j] do
				friendlies[j] = friendly[j][1]
				j = j + 1
			end
			friendlies = TableToString(friendlies)
			j = 1
			local friendliesTypes = {}
			while friendly[j] do
				friendliesTypes[j] = friendly[j][2]
				j = j + 1
			end
			friendliesTypes = TableToString(friendliesTypes)
			j = 1
			local friendliesPrototypes = {}
			while friendly[j] do
				friendliesPrototypes[j] = friendly[j][3]
				j = j + 1
			end
			friendliesPrototypes = TableToString(friendliesPrototypes)
			j = 1
			local friendliesHealth = {}
			while friendly[j] do
				friendliesHealth[j] = friendly[j][4]
				j = j + 1
			end
			friendliesHealth = TableToString(friendliesHealth)
			j = 1
			local friendliesVehicleHealth = {}
			while friendly[j] do
				friendliesVehicleHealth[j] = friendly[j][5]
				j = j + 1
			end
			friendliesVehicleHealth = TableToString(friendliesVehicleHealth)
			j = 1
			local friendliesFirepower = {}
			while friendly[j] do
				friendliesFirepower[j] = friendly[j][6]
				j = j + 1
			end
			friendliesFirepower = TableToString(friendliesFirepower)
			j = 1
			local friendliesManeuverability = {}
			while friendly[j] do
				friendliesManeuverability[j] = friendly[j][7]
				j = j + 1
			end
			friendliesManeuverability = TableToString(friendliesManeuverability)
			j = 1
			local friendliesNames = {}
			while friendly[j] do
				friendliesNames[j] = friendly[j][8]
				j = j + 1
			end
			friendliesNames = TableToString(friendliesNames)

			j = 1
			local enemies = {}
			while enemy[j] do
				enemies[j] = enemy[j][1]
				j = j + 1
			end
			enemies = TableToString(enemies)
			j = 1
			local enemiesHealth = {}
			while enemy[j] do
				enemiesHealth[j] = enemy[j][2]
				j = j + 1
			end
			enemiesHealth = TableToString(enemiesHealth)
			j = 1
			local enemiesVehicleHealth = {}
			while enemy[j] do
				enemiesVehicleHealth[j] = enemy[j][3]
				j = j + 1
			end
			enemiesVehicleHealth = TableToString(enemiesVehicleHealth)
			j = 1
			local enemiesFirepower = {}
			while enemy[j] do
				enemiesFirepower[j] = enemy[j][4]
				j = j + 1
			end
			enemiesFirepower = TableToString(enemiesFirepower)
			j = 1
			local enemiesManeuverability = {}
			while enemy[j] do
				enemiesManeuverability[j] = enemy[j][5]
				j = j + 1
			end
			enemiesManeuverability = TableToString(enemiesManeuverability)
			SetVar("TotalMissionScore", 0) -- total score gained, gets updated after mission stats calculation with the info about destroyed enemy units; score for enemy units is decided by their firepower
			SetVar("ObjectivesCompleted", 0)
			SetVar("Friendlies", friendlies)
			SetVar("FriendliesTypes", friendliesTypes)
			SetVar("FriendliesPrototypes", friendliesPrototypes)
			SetVar("FriendliesHealth", friendliesHealth) -- friendlies effective hp
			SetVar("FriendliesVehicleHealth", friendliesVehicleHealth) -- friendlies real hp according to the vehicle stats, used in UpdateUnitsStats
			SetVar("FriendliesEndHealth", friendliesHealth) -- friendlies hp at the end of the mission, are updated by UpdateUnitsStats
			SetVar("FriendliesFirepower", friendliesFirepower)
			SetVar("FriendliesManeuverability", friendliesManeuverability)
			SetVar("FriendliesNames", friendliesNames)
			SetVar("Enemies", enemies)
			SetVar("EnemiesHealth", enemiesHealth) -- enemies effective hp
			SetVar("EnemiesVehicleHealth", enemiesVehicleHealth) -- enemies real hp according to the vehicle stats, used in UpdateUnitsStats
			SetVar("EnemiesEndHealth", enemiesHealth) -- enemies hp at the end of the mission, are updated by UpdateUnitsStats
			SetVar("EnemiesFirepower", enemiesFirepower)
			SetVar("EnemiesManeuverability", enemiesManeuverability)
			

			if not getObj("ThePendulum") then
				CreateVehicleEx("PendulumVehicle01", "ThePendulum", CVector(30, 255, 80), 1486)
				local Maschine = getObj("ThePendulum")
				if Maschine then
					Maschine:setGodMode(1)
					Maschine:setImmortalMode(1)
					Maschine:SetExternalPathByName("PendulumPath")
					
					TActivate("trPendulum")
				end
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trPendulum" active="0">
		<event eventid="GE_TARGET_REACHED" ObjName="ThePendulum" />
		<event eventid="GE_GAME_START" ObjName="Player1" />
		<script>
			local Maschine = GetEntityByName("ThePendulum")
			if Maschine then
				Maschine:SetLinearVelocity(CVector(0, 0, 0))
				Maschine:SetExternalPathByName("PendulumPath")
				local PendulumStat = GetVar("PendulumStatus").AsInt
				local MissionTime = GetVar("MissionTime").AsInt
				if 50>PendulumStat then
					PendulumStat = PendulumStat + 1
					SetVar("PendulumStatus", PendulumStat)
					println("pendstat set to "..PendulumStat)
					MissionTime = MissionTime + 8
					SetVar("MissionTime", MissionTime)
				else
					SetVar("PendulumStatus", 0)
					println("corovan management activated, pendstat set to 0")
					MissionTime = MissionTime + 8
					SetVar("MissionTime", MissionTime)
				end
			end
		
		</script>
	</trigger>

	<trigger	Name="NightvisionOff"	active="1">
		<event eventid="GE_PLAYER_VEHICLE_HORN" ObjName="Player1" />
		<script>
			RuleConsole("g_postEffect Nightvision_CD")
			
			trigger:Deactivate()

			TActivate("NightvisionOn")
			
		</script>
	</trigger>

	<trigger	Name="NightvisionOn"	active="0">
		<event eventid="GE_PLAYER_VEHICLE_HORN" ObjName="Player1" />
		<script>
			RuleConsole("g_postEffect wNight_archipelago_cloudy")

			trigger:Deactivate()

			TActivate("NightvisionOff")

		</script>
	</trigger>

	<trigger Name="RetreatStart" active="1">
		<event eventid="GE_OBJECT_LEAVES_LOCATION" ObjName="MissionStartLoc" />
		<event eventid="GE_OBJECT_LEAVES_LOCATION" ObjName="Retreat01Loc" />
		<script>
			TActivate("Retreat")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="Retreat" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="MissionStartLoc" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Retreat01Loc" />
		<script>
			local AllEnemies = StringToTable(GetVar("Enemies").AsString)
			local Enemies = {AllEnemies[1],AllEnemies[2],AllEnemies[3],AllEnemies[4],AllEnemies[5],AllEnemies[6],AllEnemies[7],AllEnemies[8],AllEnemies[9],AllEnemies[10],AllEnemies[11],AllEnemies[12],AllEnemies[13],AllEnemies[14],AllEnemies[15],AllEnemies[16],AllEnemies[17],AllEnemies[18],AllEnemies[23],AllEnemies[24],AllEnemies[25],AllEnemies[26],AllEnemies[27],AllEnemies[28],AllEnemies[29],AllEnemies[30]}

			UpdateUnitsStats()

			local b = SpawnMessageBox( "1000" )
			if b == 1 then
				trigger:Deactivate()

				local FriendliesHealth = StringToTable(GetVar("FriendliesEndHealth").AsString)
				if not(CheckUnits(Enemies, "dead", 26)) then
					if not(IsQuestComplete("CD_PH01_EscortFirst")) then
						if CheckUnits("CDMerchant01_vehicle_0") then
							FriendliesHealth[3] = 0
							SetVar("FriendliesEndHealth", TableToString(FriendliesHealth))
						end

						FailQuest("CD_PH01_EscortFirst")
					end

					if not(IsQuestComplete("CD_PH01_EscortSecond")) then
						if CheckUnits("CDMerchant02_vehicle_0") then
							FriendliesHealth[4] = 0
							SetVar("FriendliesEndHealth", TableToString(FriendliesHealth))
						end

						FailQuest("CD_PH01_EscortSecond")
					end
				end
	
				if not(IsQuestTaken("CD_PH01_Retreat")) then
					FailQuest("CD_PH01")
				else
					CompleteQuest("CD_PH01_Retreat")
				end

				FailQuestIfTaken("CD_PH01_DestroyBoats")
				FailQuestIfTaken("CD_PH01_DestroyDestroyers")
				FailQuestIfTaken("CD_PH01_DestroyTurrets")
				FailQuestIfTaken("CD_PH01_DestroyCruisers")

				UpdateUnitsStats()

				CalcMissionStats()

				PassToMap("hq", "Headquarters_enter", 90, false )
			else
				trigger:Deactivate()

				TActivate("RetreatStart")
			end
			
		</script>
	</trigger>

	<trigger Name="Leave" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Leave01Loc" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Leave02Loc" />
		<script>
			local AllEnemies = StringToTable(GetVar("Enemies").AsString)
			local Enemies = {AllEnemies[1],AllEnemies[2],AllEnemies[3],AllEnemies[4],AllEnemies[5],AllEnemies[6],AllEnemies[7],AllEnemies[8],AllEnemies[9],AllEnemies[10],AllEnemies[11],AllEnemies[12],AllEnemies[13],AllEnemies[14],AllEnemies[15],AllEnemies[16],AllEnemies[17],AllEnemies[18],AllEnemies[23],AllEnemies[24],AllEnemies[25],AllEnemies[26],AllEnemies[27],AllEnemies[28],AllEnemies[29],AllEnemies[30]}

			local FriendliesHealth = StringToTable(GetVar("FriendliesEndHealth").AsString)
			if not(CheckUnits(Enemies, "dead", 26)) then
				if not(IsQuestComplete("CD_PH01_EscortFirst")) then
					if CheckUnits("CDMerchant01_vehicle_0") then
						FriendliesHealth[3] = 0
						SetVar("FriendliesEndHealth", TableToString(FriendliesHealth))
					end

					FailQuest("CD_PH01_EscortFirst")
				end

				if not(IsQuestComplete("CD_PH01_EscortSecond")) then
					if CheckUnits("CDMerchant02_vehicle_0") then
						FriendliesHealth[4] = 0
						SetVar("FriendliesEndHealth", TableToString(FriendliesHealth))
					end

					FailQuest("CD_PH01_EscortSecond")
				end
			end

			if not(IsQuestTaken("CD_PH01_Retreat")) then
				FailQuest("CD_PH01")
			else
				CompleteQuest("CD_PH01_Retreat")
			end

			FailQuestIfTaken("CD_PH01_DestroyBoats")
			FailQuestIfTaken("CD_PH01_DestroyDestroyers")
			FailQuestIfTaken("CD_PH01_DestroyTurrets")
			FailQuestIfTaken("CD_PH01_DestroyCruisers")

			UpdateUnitsStats()

			CalcMissionStats()

			PassToMap("hq", "Headquarters_enter", 90, false)
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="WarningStart" active="0">
		<event eventid="GE_OBJECT_LEAVES_LOCATION" ObjName="Warning01Loc" />
		<event eventid="GE_OBJECT_LEAVES_LOCATION" ObjName="Warning02Loc" />
		<event eventid="GE_OBJECT_LEAVES_LOCATION" ObjName="Warning03Loc" />
		<event eventid="GE_OBJECT_LEAVES_LOCATION" ObjName="Warning04Loc" />
		<event eventid="GE_OBJECT_LEAVES_LOCATION" ObjName="Warning05Loc" />
		<event eventid="GE_OBJECT_LEAVES_LOCATION" ObjName="Warning06Loc" />
		<script>
			TActivate("Warning")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="Warning" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Warning01Loc" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Warning02Loc" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Warning03Loc" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Warning04Loc" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Warning05Loc" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Warning06Loc" />
		<script>
			local b = SpawnMessageBox( "1002" )

			TActivate("WarningStart")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="Desertion" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Desertion01Loc" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Desertion02Loc" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Desertion03Loc" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Desertion04Loc" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Desertion05Loc" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Desertion06Loc" />
		<script>
			local AllEnemies = StringToTable(GetVar("Enemies").AsString)
			local Enemies = {AllEnemies[1],AllEnemies[2],AllEnemies[3],AllEnemies[4],AllEnemies[5],AllEnemies[6],AllEnemies[7],AllEnemies[8],AllEnemies[9],AllEnemies[10],AllEnemies[11],AllEnemies[12],AllEnemies[13],AllEnemies[14],AllEnemies[15],AllEnemies[16],AllEnemies[17],AllEnemies[18],AllEnemies[23],AllEnemies[24],AllEnemies[25],AllEnemies[26],AllEnemies[27],AllEnemies[28],AllEnemies[29],AllEnemies[30]}

			local FriendliesHealth = StringToTable(GetVar("FriendliesEndHealth").AsString)
			if not(CheckUnits(Enemies, "dead", 26)) then
				if not(IsQuestComplete("CD_PH01_EscortFirst")) then
					if CheckUnits("CDMerchant01_vehicle_0") then
						FriendliesHealth[3] = 0
						SetVar("FriendliesEndHealth", TableToString(FriendliesHealth))
					end

					FailQuest("CD_PH01_EscortFirst")
				end

				if not(IsQuestComplete("CD_PH01_EscortSecond")) then
					if CheckUnits("CDMerchant02_vehicle_0") then
						FriendliesHealth[4] = 0
						SetVar("FriendliesEndHealth", TableToString(FriendliesHealth))
					end

					FailQuest("CD_PH01_EscortSecond")
				end
			end

			if not(IsQuestTaken("CD_PH01_Retreat")) then
				FailQuest("CD_PH01")
			else
				FailQuest("CD_PH01_Retreat") -- the trigger is identical to Leave, besides this (FailQuest)
			end

			FailQuestIfTaken("CD_PH01_DestroyBoats")
			FailQuestIfTaken("CD_PH01_DestroyDestroyers")
			FailQuestIfTaken("CD_PH01_DestroyTurrets")
			FailQuestIfTaken("CD_PH01_DestroyCruisers")

			UpdateUnitsStats(1) -- the trigger is identical to Leave, besides this (1)

			CalcMissionStats(1) -- the trigger is identical to Leave, besides this (1)

			PassToMap("hq", "Headquarters_enter", 90, false)
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="MissionStart" active="1">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			-- ================
			--  Main CD Force
			-- ================
			TeamCreate("CDDestroyer01", 1053, CVector(3091, 255, 3737), {"CDPH01_DestroyerCD01"})
			TeamCreate("CDDestroyer02", 1053, CVector(2579, 255, 3907), {"CDPH01_DestroyerCD02"})
			CreateVehicleEx("CDPH01_MerchantCD01", "CDMerchant01_vehicle_0", CVector(2957, 255, 3888), 1051)
			CreateVehicleEx("CDPH01_MerchantCD02", "CDMerchant02_vehicle_0", CVector(2713, 255, 3780), 1051)
			local CDD01 = getObj("CDDestroyer01")
			local CDD02 = getObj("CDDestroyer02")

			if CITB01 then
				CITB01:SetProperty ("TeamTacticPrototype", "StandardTactic")
				CITB01:_AdjustBehaviour ()
			end

			if CITB02 then
				CITB02:SetProperty ("TeamTacticPrototype", "StandardTactic")
				CITB02:_AdjustBehaviour ()
			end

			local CDD01a = getObj("CDDestroyer01_vehicle_0")
			local CDD02a = getObj("CDDestroyer02_vehicle_0")
			local CDM01a = getObj("CDMerchant01_vehicle_0")
			local CDM02a = getObj("CDMerchant02_vehicle_0")

			if CDD01a then
				CDD01a:SetRotation(Quaternion(0.0000, 0.6428, 0.0000, 0.7660))
				CDD01a:SetCruisingSpeed(3)
				CDD01a:SetExternalPathByName("StartPath_CDDestroyer01")
			end
			
			if CDD02a then
				CDD02a:SetRotation(Quaternion(0.0000, 0.6428, 0.0000, 0.7660))
				CDD02a:SetCruisingSpeed(3)
				CDD02a:SetExternalPathByName("StartPath_CDDestroyer02")
			end

			if CDM01a then
				CDM01a:SetRotation(Quaternion(0.0000, 0.6428, 0.0000, 0.7660))
				CDM01a:SetCruisingSpeed(3)
				CDM01a:SetExternalPathByName("StartPath_CDMerchant01")
			end

			if CDM02a then
				CDM02a:SetRotation(Quaternion(0.0000, 0.6428, 0.0000, 0.7660))
				CDM02a:SetCruisingSpeed(3)
				CDM02a:SetExternalPathByName("StartPath_CDMerchant02")
			end

			-- ===============
			--  Main CIT Force
			-- ===============
			TeamCreate("CITDestroyer01", 1003, CVector(5791, 255, 3227), {"CDPH01_DestroyerCIT01"})
			TeamCreate("CITDestroyer02", 1003, CVector(5805, 255, 3081), {"CDPH01_DestroyerCIT02"})
			TeamCreate("CITDestroyer03", 1003, CVector(5929, 255, 3028), {"CDPH01_DestroyerCIT02"})
			TeamCreate("CITDestroyer04", 1003, CVector(5931, 255, 2897), {"CDPH01_DestroyerCIT01"})

			TeamCreate("CITTorpedoBoat01", 1002, CVector(4118, 255, 5683), {"CDPH01_FastboatCIT01"})
			TeamCreate("CITTorpedoBoat02", 1002, CVector(4180, 255, 5763), {"CDPH01_FastboatCIT02"})
			TeamCreate("CITTorpedoBoat03", 1002, CVector(4122, 255, 5759), {"CDPH01_FastboatCIT01"})
			TeamCreate("CITTorpedoBoat04", 1002, CVector(4064, 255, 5751), {"CDPH01_FastboatCIT02"})

			TeamCreate("CITBoat01", 1002, CVector(5785, 255, 4025), {"CDPH01_SmlboatCIT01"})
			TeamCreate("CITBoat02", 1002, CVector(5878, 255, 4045), {"CDPH01_SmlboatCIT01"})
			TeamCreate("CITBoat03", 1002, CVector(6151, 255, 3981), {"CDPH01_SmlboatCIT01"})
			TeamCreate("CITBoat04", 1002, CVector(6197, 255, 3973), {"CDPH01_SmlboatCIT01"})
			TeamCreate("CITBoat05", 1002, CVector(6218, 255, 3989), {"CDPH01_SmlboatCIT01"})

			CreateCaravanTeam("CITLav01", 1010, CVector(5790, 285, 3907), {"CDPH01_LavCIT01"})
			CreateCaravanTeam("CITLav02", 1010, CVector(5818, 285, 3912), {"CDPH01_LavCIT01"})
			CreateCaravanTeam("CITLav03", 1010, CVector(5839, 285, 3919), {"CDPH01_LavCIT01"})
			CreateCaravanTeam("CITLav04", 1010, CVector(6334, 278, 3897), {"CDPH01_LavCIT01"})
			CreateCaravanTeam("CITLav05", 1010, CVector(6334, 288, 3805), {"CDPH01_LavCIT01"})

			CreateNewDummyObject( "quay_big_cube",	"psaradon_fortress_01", -1, -1, CVector(5839.552, 271.012, 3919.798), Quaternion(0.0000, -0.1715, 0.0000, 0.9852), 1 )
			CreateNewDummyObject( "quay_big_cube",	"psaradon_fortress_02", -1, -1, CVector(5814.607, 271.009, 3911.965), Quaternion(0.0000, -0.1327, 0.0000, 0.9912), 1 )
			CreateNewDummyObject( "quay_big_cube",	"psaradon_fortress_03", -1, -1, CVector(5789.850, 271.012, 3906.973), Quaternion(0.0000, -0.0785, 0.0000, 0.9969), 1 )
			CreateNewDummyObject( "quay_big_cube",	"psaradon_fortress_04", -1, -1, CVector(5769.851, 271.009, 3906.660), Quaternion(0.0000, 0.0240, 0.0000, 0.9997), 1 )
			CreateNewDummyObject( "quay_big_cube",	"psaradon_fortress_05", -1, -1, CVector(5826.790, 268.922, 3934.929), Quaternion(0.0000, -0.2250, 0.0000, 0.9744), 1 )
			CreateNewDummyObject( "quay_big_cube",	"psaradon_fortress_06", -1, -1, CVector(5801.691, 268.904, 3925.217), Quaternion(0.0000, -0.1413, 0.0000, 0.9900), 1 )
			CreateNewDummyObject( "quay_big_cube",	"psaradon_fortress_07", -1, -1, CVector(5773.882, 268.922, 3921.546), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			CreateNewDummyObject( "berth",	"psaradon_fortress_08", -1, -1, CVector(5816.011, 273.555, 3976.860), Quaternion(0.0000, -0.1758, 0.0000, 0.9844), 1 )
			CreateNewBreakableObject("CITCoastMed01", "CITCoastalGun01", 1008, CVector(5831.876, 281.304, 3934.007), Quaternion(0.0000, -0.1693, 0.0000, 0.9856), 0)
			CreateNewBreakableObject("CITCoastMed01", "CITCoastalGun02", 1008, CVector(5812.080, 281.361, 3928.176), Quaternion(0.0000, -0.1478, 0.0000, 0.9890), 0)
			CreateNewBreakableObject("CITCoastMed01", "CITCoastalGun03", 1008, CVector(5787.776, 281.478, 3923.159), Quaternion(0.0000, -0.0676, 0.0000, 0.9977), 0)
			CreateNewBreakableObject("CITCoastMed01", "CITCoastalGun04", 1008, CVector(5766.433, 281.459, 3923.029), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 0)
			CreateNewBreakableObject("CoastAAMed01", "CITAAGun01", 1008, CVector(5828.910, 283.012, 3923.542), Quaternion(0.0000, -0.1780, 0.0000, 0.9840), 0)
			CreateNewBreakableObject("CoastAAMed01", "CITAAGun02", 1008, CVector(5802.010, 283.015, 3915.930), Quaternion(0.0000, -0.1284, 0.0000, 0.9917), 0)
			CreateNewBreakableObject("CoastAAMed01", "CITAAGun03", 1008, CVector(5775.906, 283.012, 3914.277), Quaternion(0.0000, -0.0305, 0.0000, 0.9995), 0)
			CreateNewBreakableObject("CoastAAMed01", "CITAAGun04", 1008, CVector(5837.038, 280.746, 3940.914), Quaternion(0.0000, -0.2292, 0.0000, 0.9734), 0)
			CreateNewBreakableObject("CoastAAMed01", "CITAAGun05", 1008, CVector(5799.207, 280.671, 3927.987), Quaternion(0.0000, -0.1435, 0.0000, 0.9897), 0)
			CreateNewBreakableObject("CoastAAMed01", "CITAAGun06", 1008, CVector(5761.366, 280.759, 3926.877), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 0)

			local CITD01 = getObj("CITDestroyer01")
			local CITD02 = getObj("CITDestroyer02")
			local CITD03 = getObj("CITDestroyer03")
			local CITD04 = getObj("CITDestroyer04")
			local CITTB01 = getObj("CITTorpedoBoat01")
			local CITTB02 = getObj("CITTorpedoBoat02")
			local CITTB03 = getObj("CITTorpedoBoat03")
			local CITTB04 = getObj("CITTorpedoBoat04")
			local CITB01 = getObj("CITBoat01")
			local CITB02 = getObj("CITBoat02")
			local CITB03 = getObj("CITBoat03")
			local CITB04 = getObj("CITBoat04")
			local CITB05 = getObj("CITBoat05")
			local CITL01 = getObj("CITLav01")
			local CITL02 = getObj("CITLav02")
			local CITL03 = getObj("CITLav03")
			local CITL04 = getObj("CITLav04")
			local CITL05 = getObj("CITLav05")

			if CITD01 then
				CITD01:SetProperty ("TeamTacticPrototype", "BoxTactic")
				CITD01:_AdjustBehaviour ()
			end

			if CITD02 then
				CITD02:SetProperty ("TeamTacticPrototype", "StandardTactic")
				CITD02:_AdjustBehaviour ()
			end

			if CITD03 then
				CITD03:SetProperty ("TeamTacticPrototype", "StandardTactic")
				CITD03:_AdjustBehaviour ()
			end

			if CITD04 then
				CITD04:SetProperty ("TeamTacticPrototype", "BoxTactic")
				CITD04:_AdjustBehaviour ()
			end

			if CITTB01 then
				CITTB01:SetProperty ("TeamTacticPrototype", "AssaultBottomTactic")
				CITTB01:_AdjustBehaviour ()
			end

			if CITTB02 then
				CITTB02:SetProperty ("TeamTacticPrototype", "StandardTactic")
				CITTB02:_AdjustBehaviour ()
			end

			if CITTB03 then
				CITTB03:SetProperty ("TeamTacticPrototype", "AssaultBottomTactic")
				CITTB03:_AdjustBehaviour ()
			end

			if CITTB04 then
				CITTB04:SetProperty ("TeamTacticPrototype", "StandardTactic")
				CITTB04:_AdjustBehaviour ()
			end

			if CITL01 then
				CITL01:SetProperty ("TeamTacticPrototype", "CowardTeamTactic")
				CITL01:_AdjustBehaviour ()
			end

			if CITL02 then
				CITL02:SetProperty ("TeamTacticPrototype", "CowardTeamTactic")
				CITL02:_AdjustBehaviour ()
			end

			if CITL03 then
				CITL03:SetProperty ("TeamTacticPrototype", "CowardTeamTactic")
				CITL03:_AdjustBehaviour ()
			end

			if CITL04 then
				CITL04:SetProperty ("TeamTacticPrototype", "CowardTeamTactic")
				CITL04:_AdjustBehaviour ()
			end

			if CITL05 then
				CITL05:SetProperty ("TeamTacticPrototype", "CowardTeamTactic")
				CITL05:_AdjustBehaviour ()
			end

			local CITD01a = getObj("CITDestroyer01_vehicle_0")
			local CITD02a = getObj("CITDestroyer02_vehicle_0")
			local CITD03a = getObj("CITDestroyer03_vehicle_0")
			local CITD04a = getObj("CITDestroyer04_vehicle_0")
			local CITTB01a = getObj("CITTorpedoBoat01_vehicle_0")
			local CITTB02a = getObj("CITTorpedoBoat02_vehicle_0")
			local CITTB03a = getObj("CITTorpedoBoat03_vehicle_0")
			local CITTB04a = getObj("CITTorpedoBoat04_vehicle_0")
			local CITB01a = getObj("CITBoat01_vehicle_0")
			local CITB02a = getObj("CITBoat02_vehicle_0")
			local CITB03a = getObj("CITBoat03_vehicle_0")
			local CITB04a = getObj("CITBoat04_vehicle_0")
			local CITB05a = getObj("CITBoat05_vehicle_0")
			local CITL01a = getObj("CITLav01_vehicle_0")
			local CITL02a = getObj("CITLav02_vehicle_0")
			local CITL03a = getObj("CITLav03_vehicle_0")
			local CITL04a = getObj("CITLav04_vehicle_0")
			local CITL05a = getObj("CITLav05_vehicle_0")

			if CITL01a then
				CITL01a:SetRotation(Quaternion(0.0000, 0.8077, 0.0000, -0.5895))
				CITL01a:SetMaxSpeed(0)
				CITL01a:SetMaxTorque(1)
			end

			if CITL02a then
				CITL02a:SetRotation(Quaternion(0.0000, -0.4266, 0.0000, 0.9045))
				CITL02a:SetMaxSpeed(0)
				CITL02a:SetMaxTorque(1)
			end

			if CITL03a then
				CITL03a:SetRotation(Quaternion(0.0000, 0.8077, 0.0000, -0.5895))
				CITL03a:SetMaxSpeed(0)
				CITL03a:SetMaxTorque(1)
			end

			if CITL04a then
				CITL04a:SetRotation(Quaternion(0.0000, 0.8077, 0.0000, -0.5895))
				CITL04a:SetMaxSpeed(0)
				CITL04a:SetMaxTorque(1)
			end

			if CITL05a then
				CITL05a:SetRotation(Quaternion(0.0000, 0.8077, 0.0000, -0.5895))
				CITL05a:SetMaxSpeed(0)
				CITL05a:SetMaxTorque(1)
			end

			if CDB02a then
				CDB02a:SetRotation(Quaternion(0.0000, 0.6070, 0.0000, 0.7947))
			end
			if CDB02a then
				CDB02b:SetGamePositionOnGround(CVector(4792.728, 255, 1415.879))
				CDB02b:SetRotation(Quaternion(0.0000, -0.2186, 0.0000, 0.9758))
			end

			-- =============
			--  CIT Reserves
			-- =============
			TeamCreate("CITOldCruiser01", 1003, CVector(4610, 255, 5932), {"CDPH01_OCruiserCIT01"})
			TeamCreate("CITDestroyer05", 1003, CVector(4585, 255, 6081), {"CDPH01_DestroyerCIT02"})
			TeamCreate("CITOldCruiser02", 1003, CVector(4484, 255, 6158), {"CDPH01_OCruiserCIT03"})
			TeamCreate("CITOldCruiser03", 1003, CVector(4464, 255, 6291), {"CDPH01_OCruiserCIT02"})

			TeamCreate("CITHelicopter01", 1006, CVector(4200, 255, 6339), {"CDPH01_HeliCIT0"..math.random(4)})
			TeamCreate("CITHelicopter02", 1006, CVector(4216, 255, 6417), {"CDPH01_HeliCIT0"..math.random(4)})
			TeamCreate("CITHelicopter03", 1006, CVector(6853, 255, 6274), {"CDPH01_HeliCIT0"..math.random(4)})
			TeamCreate("CITHelicopter04", 1006, CVector(6852, 255, 6346), {"CDPH01_HeliCIT0"..math.random(4)})

			-- =========
			--  Trigger
			-- =========
			local Plf = GetPlayerVehicle()
			if Plf then
				Plf:SetPosition(CVector(2846, 275, 3987))
				Plf:SetRotation(Quaternion(0.0000, 0.6428, 0.0000, 0.7660))
				Plf:SetExternalPathByName("StartPath_Player")
				Plf:SetCruisingSpeed(3)
			end
			local PlfID = GetPlayerVehicleId()
			FlyLinked( "CDPH01_Start1", PlfID, 30, 0, 1, PlfID )
			StartCinematic()

			AddCinematicMessage( 1, 2)
			AddCinematicMessage( 2, 1)
			AddCinematicMessage( 3, 1)

			TActivate("MissionStart_End")
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="MissionStart_End" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			local Plf = GetPlayerVehicle()
			if Plf then
				Plf:PlaceToEndOfPath("StartPath_Player")
			end

			local CDD01a = getObj("CDDestroyer01_vehicle_0")
			local CDD02a = getObj("CDDestroyer02_vehicle_0")
			local CDM01a = getObj("CDMerchant01_vehicle_0")
			local CDM02a = getObj("CDMerchant02_vehicle_0")

			if CDD01a then
				CDD01a:PlaceToEndOfPath("StartPath_CDDestroyer01")
				CDD01a:SetCruisingSpeed(3)
				CDD01a:SetExternalPathByName("CDDestroyer01_Waypoint1")
				CDD01a:SetCanBeDistractedFromMoving(true)

				SetVar("CDDestroyer01WaypointStatus", TableToString({0, 2, 0})) -- waypoints reached, amount of waypoints, amount of cycles with 0 speed
			end
			
			if CDD02a then
				CDD02a:PlaceToEndOfPath("StartPath_CDDestroyer02")
				CDD02a:SetCruisingSpeed(3)
				CDD02a:SetExternalPathByName("CDDestroyer02_Waypoint1")
				CDD02a:SetCanBeDistractedFromMoving(true)

				SetVar("CDDestroyer02WaypointStatus", TableToString({0, 2, 0}))
			end

			if CDM01a then
				CDM01a:PlaceToEndOfPath("StartPath_CDMerchant01")
				CDM01a:SetCruisingSpeed(3)
				CDM01a:SetExternalPathByName("CDMerchant01_Waypoint1")
			end

			if CDM02a then
				CDM02a:PlaceToEndOfPath("StartPath_CDMerchant02")
				CDM02a:SetCruisingSpeed(3)
				CDM02a:SetExternalPathByName("CDMerchant02_Waypoint1")
			end

			local CITTB01a = getObj("CITTorpedoBoat01_vehicle_0")
			local CITTB02a = getObj("CITTorpedoBoat02_vehicle_0")
			local CITTB03a = getObj("CITTorpedoBoat03_vehicle_0")
			local CITTB04a = getObj("CITTorpedoBoat04_vehicle_0")
			local CITD01a = getObj("CITDestroyer01_vehicle_0")
			local CITD02a = getObj("CITDestroyer02_vehicle_0")
			local CITD03a = getObj("CITDestroyer03_vehicle_0")
			local CITD04a = getObj("CITDestroyer04_vehicle_0")

			if CITTB01a then
				CITTB01a:SetCruisingSpeed(20)
				CITTB01a:SetExternalPathByName("CITTorpedoBoat01_Waypoint1")
				CITTB01a:SetCanBeDistractedFromMoving(true)
			end

			if CITTB02a then
				CITTB02a:SetCruisingSpeed(20)
				CITTB02a:SetExternalPathByName("CITTorpedoBoat02_Waypoint1")
				CITTB02a:SetCanBeDistractedFromMoving(true)
			end

			if CITTB03a then
				CITTB03a:SetCruisingSpeed(20)
				CITTB03a:SetExternalPathByName("CITTorpedoBoat03_Waypoint1")
				CITTB03a:SetCanBeDistractedFromMoving(true)
			end

			if CITTB04a then
				CITTB04a:SetCruisingSpeed(20)
				CITTB04a:SetExternalPathByName("CITTorpedoBoat04_Waypoint1")
				CITTB04a:SetCanBeDistractedFromMoving(true)
			end

			if CITD01a then
				CITD01a:SetCruisingSpeed(5)
				CITD01a:SetExternalPathByName("CITDestroyer01_Waypoint1")
				CITD01a:SetCanBeDistractedFromMoving(true)
			end

			if CITD02a then
				CITD02a:SetCruisingSpeed(5)
				CITD02a:SetExternalPathByName("CITDestroyer02_Waypoint1")
				CITD02a:SetCanBeDistractedFromMoving(true)
			end

			if CITD03a then
				CITD03a:SetCruisingSpeed(5)
				CITD03a:SetExternalPathByName("CITDestroyer03_Waypoint1")
				CITD03a:SetCanBeDistractedFromMoving(true)
			end

			if CITD04a then
				CITD04a:SetCruisingSpeed(5)
				CITD04a:SetExternalPathByName("CITDestroyer04_Waypoint1")
				CITD04a:SetCanBeDistractedFromMoving(true)
			end

			TakeQuest("CD_PH01")
			TakeQuest("CD_PH01_DestroyTurrets")

			TActivate("CDMerchantsTargetReached")
			TActivate("CDMerchantsDestroyed")
			TActivate("CDDestroyersFormationManager")
			TActivate("CITTorpedoBoatsFormationManager")
			TActivate("CITDestroyersFormationManager")
			TActivate("CITTorpedoBoatsDestroyed")
			TActivate("CITDestroyersDestroyed")
			TActivate("CITCoastalGunsDestroyed")
			TActivate("CITOldCruisersDestroyed")
			TActivate("CITTorpedoBoatsOrder")
			TActivate("CITDestroyersOrder")
			TActivate("CITCoastalGunsOrder")
			TActivate("CITOldCruisersOrder")
			TActivate("CITHelicoptersOrder")
			TActivate("CITReinforcements")

			SetVar("MissionStage", 1)

			TActivate("Leave")
			TActivate("AutoSave")
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="AutoSave" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			local Plf = GetPlayerVehicle()
			if Plf then
				Plf:setGodMode(1)
			end

			trigger:Deactivate()

			TActivate("AutoReload")

			AutoSave()
			
		</script>
	</trigger>

	<trigger Name="AutoReload" active="0">
		<event timeout="0.1" eventid="GE_TIME_PERIOD" />
		<script>
			local Plf = GetPlayerVehicle()

			if Plf:getGodMode() then
				SpawnMessageBox( "1003" )
				ShowDeathMenu()
			else
				AddImportantFadingMsgByStrIdFormatted("fm_nightvision")
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="CDMerchantsTargetReached" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="MerchantDestinationLoc" />
		<script>
			local FriendliesEndHealth = StringToTable(GetVar("FriendliesEndHealth").AsString)
			local FriendliesFirepower = StringToTable(GetVar("FriendliesFirepower").AsString)
			local FriendliesManeuverability = StringToTable(GetVar("FriendliesManeuverability").AsString)
			local Enemies = StringToTable(GetVar("Enemies").AsString)

			UpdateUnitsStats()

			if CheckUnits("CDMerchant01_vehicle_0") then
				CompleteQuestIfTaken("CD_PH01_EscortFirst")
				getObj("CDMerchant01_vehicle_0"):setImmortalMode(1)
--				FriendliesEndHealth[3] = 30000
				FriendliesFirepower[3] = 30000
				FriendliesManeuverability[3] = 30000
			else
				FailQuestIfTaken("CD_PH01_EscortFirst")
			end

			if CheckUnits("CDMerchant02_vehicle_0") then
				CompleteQuestIfTaken("CD_PH01_EscortSecond")
				getObj("CDMerchant02_vehicle_0"):setImmortalMode(1)
--				FriendliesEndHealth[4] = 30000
				FriendliesFirepower[4] = 30000
				FriendliesManeuverability[4] = 30000
			else
				FailQuestIfTaken("CD_PH01_EscortSecond")
			end

			SetVar("FriendliesEndHealth", TableToString(FriendliesEndHealth))
			SetVar("FriendliesFirepower", TableToString(FriendliesFirepower))
			SetVar("FriendliesManeuverability", TableToString(FriendliesManeuverability))

			TakeQuest("CD_PH01_Retreat")

			if CheckDistBetweenUnits(GetPlayerVehicle(), Enemies, "least") > 1000 then
				local b = SpawnMessageBox( "1001" )
				if b == 1 then
					CompleteQuestIfTaken("CD_PH01_Retreat")

					UpdateUnitsStats()

					CalcMissionStats()

					println("mission end 1")

					PassToMap("hq", "Headquarters_enter", 90, false )
				end
			end

			println("mission end 0")
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="CDMerchantsDestroyed" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="CDMerchant01_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CDMerchant02_vehicle_0" />
		<script>
			local CDMerchantsDestroyed = 0

			UpdateUnitsStats()

			if not(CheckUnits("CDMerchant01_vehicle_0")) then
				FailQuestIfTaken("CD_PH01_EscortFirst")
				CDMerchantsDestroyed = CDMerchantsDestroyed + 1
			end

			if not(CheckUnits("CDMerchant02_vehicle_0")) then
				FailQuestIfTaken("CD_PH01_EscortSecond")
				CDMerchantsDestroyed = CDMerchantsDestroyed + 1
			end

			if CDMerchantsDestroyed >= 2 then
				TakeQuest("CD_PH01_Retreat")

				trigger:Deactivate()
			end

		</script>
	</trigger>

	<trigger Name="CDDestroyersFormationManager" active="0">
		<event eventid="GE_TARGET_REACHED" ObjName="CDDestroyer01_vehicle_0" />
		<event eventid="GE_TARGET_REACHED" ObjName="CDDestroyer02_vehicle_0" />
		<event eventid="GE_TARGET_REACHED" ObjName="ThePendulum" />
		<script>
			local MissionStage = GetVar("MissionStage").AsInt

			local CDD01a = getObj("CDDestroyer01_vehicle_0")
			local CDD02a = getObj("CDDestroyer02_vehicle_0")
			local CDM01a = getObj("CDMerchant01_vehicle_0")
			local CDM02a = getObj("CDMerchant02_vehicle_0")

			if CDD01a then
				if MissionStage == 3 then
					LOG("990")
					CDD01a:SetCruisingSpeed(10)
				elseif MissionStage == 2 then
					LOG("993")
					CDD01a:SetCruisingSpeed(7)
				else
					LOG("996")
					CDD01a:SetCruisingSpeed(3)
				end
			end

			LOG("1001")
			if CDD02a then
				if MissionStage == 3 then
					LOG("1004")
					CDD02a:SetCruisingSpeed(7)
				elseif MissionStage == 2 then
					LOG("1007")
					CDD02a:SetCruisingSpeed(5)
				else
					LOG("1010")
					CDD02a:SetCruisingSpeed(3)
				end
			end

			LOG("1015")
			if CDM01a then
				if MissionStage == 3 then
					LOG("1018")
					CDM01a:SetCruisingSpeed(2)
				else
					LOG("1021")
					CDM01a:SetCruisingSpeed(3)
				end
			end

			LOG("1026")
			if CDM02a then
				if MissionStage >= 2 then
					LOG("1029")
					CDM02a:SetCruisingSpeed(4)
				else
					LOG("1032")
					CDM02a:SetCruisingSpeed(3)
				end
			end

			LOG("1037")
			-- ================ --
			-- Waypoint Manager --
			-- ================ --
			local vehicles = {"CDDestroyer01", "CDDestroyer02"}
			local currentVehicleName -- "CDDestroyer01"
			local currentVehicle -- = getObj("CDDestroyer01_vehicle_0")
			local currentVehicleWaypointInfo -- = StringToTable(GetVar("CDD01aWaypointStatus").AsString)
			local speedThreshold = 3 -- the speed at which the vehicle is deemed suspiciously still
			local checksAmount = 0
			local currentWaypoint = 0
			local vehicleTargetsReached = 0 -- the amount of vehicles that reached the targets, if it equals to the amount of entries in the 'vehicles' table - the trigger deactivates
			LOG("1049")
			local triggerObjName = trigger:GetCallObjName()
			LOG("1051")
			for i=1, getn(vehicles) do
				LOG(i.." 1053")
				currentVehicleName = vehicles[i]
				currentVehicle = getObj(currentVehicleName.."_vehicle_0")
				LOG(i.." 1056")
				if triggerObjName==currentVehicleName.."_vehicle_0" then
					LOG(i.." 1058")
					println("trigger object is "..currentVehicleName)
					currentVehicleWaypointInfo = StringToTable(GetVar(currentVehicleName.."WaypointStatus").AsString)
					currentWaypoint = currentVehicleWaypointInfo[1] + 2
					LOG(i.." 1062")
					if currentVehicleWaypointInfo[2] > currentWaypoint then
						LOG(i.." 1064")
						println("there are waypoints for "..currentVehicleName)
						currentVehicle:SetExternalPathByName(currentVehicleName.."_Waypoint"..currentWaypoint) -- the vehicle is set on the path for the next waypoint
						LOG(i.." 1067")
						currentVehicle:SetCanBeDistractedFromMoving(true) -- set this to false or remove the line if this trigger is used for racing, lol
--						currentVehicleWaypointInfo[1] = currentWaypoint - 1
--						SetVar(currentVehicleName.."WaypointStatus", TableToString(currentVehicleWaypointInfo))
						println(currentVehicleName.." is set for a new waypoint")
						LOG(currentVehicleName.." is set for a new waypoint")
					else
						LOG(i.." 1074")
						println("maximum waypoints for "..currentVehicleName.." reached")
					end

					LOG(i.." 1078")
					currentWaypoint = currentWaypoint - 1
					currentVehicleWaypointInfo[1] = currentWaypoint
					currentVehicleWaypointInfo[3] = checksAmount
					LOG(i.." 1082")
					SetVar(currentVehicleName.."WaypointStatus", TableToString(currentVehicleWaypointInfo))
					println(currentVehicleName.." waypoint info updated")
					LOG(i.." 1085")

					break
				elseif triggerObjName=="ThePendulum" then
					LOG(i.." 1089")
					println("trigger object is the pendulum")
					-- it's pendulum that triggered the activation
					-- check if the ships are moving
					-- if they haven't moved for 3 cycles = set them on the current waypoint
					for j=1, getn(vehicles) do
						LOG(j.." 1095")
						currentVehicleName = vehicles[j]
						currentVehicle = getObj(currentVehicleName.."_vehicle_0")
						LOG(j.." 1098")
						if currentVehicle then
							LOG(j.." 1100")
							println(currentVehicleName.." exists")
							currentVehicleWaypointInfo = StringToTable(GetVar(currentVehicleName.."WaypointStatus").AsString)
							currentWaypoint = currentVehicleWaypointInfo[1] + 1
							LOG(j.." 1104")
							if 3 > GetSpeed(currentVehicle) then
								LOG(j.." 1106")
								println(currentVehicleName.." speed is too low")
								checksAmount = currentVehicleWaypointInfo[3] + 1 -- the speed of the vehicle is too low, the check has passed one more time
								println("checks amount is "..checksAmount)
								LOG(j.." 1110")
								if checksAmount >= 3 then
									LOG(j.." 1112")
									println("there have been 3 checks for "..currentVehicleName)
--									currentWaypoint = currentVehicleWaypointInfo[1] + 1
									if currentVehicleWaypointInfo[2] > currentWaypoint then
										LOG(j.." 1116")
										currentVehicle:SetExternalPathByName(currentVehicleName.."_Waypoint"..currentWaypoint) -- the vehicle is set on the path for the current waypoint
										currentVehicle:SetCanBeDistractedFromMoving(true) -- set this to false or remove the line if this trigger is used for racing, lol
										println(currentVehicleName.." set for the current waypoint")
										LOG(j.." 1120")
									else
										LOG(j.." 1122")
										println("maximum waypoints for "..currentVehicleName.." reached")
									end
								end
							else
								LOG(j.." 1127")
								println(currentVehicleName.." speed is fine")
								checksAmount = 0 -- the speed of the vehicle is okay, the checks are dropped
							end

							LOG(j.." 1132")
							currentWaypoint = currentWaypoint - 1
							currentVehicleWaypointInfo[1] = currentWaypoint
							currentVehicleWaypointInfo[3] = checksAmount
							SetVar(currentVehicleName.."WaypointStatus", TableToString(currentVehicleWaypointInfo))
							println(currentVehicleName.." waypoint info updated")
							LOG(j.." 1138")
							if currentVehicleWaypointInfo[1] >= currentVehicleWaypointInfo[2] then
								LOG(j.." 1140")
								vehicleTargetsReached = vehicleTargetsReached + 1
							end
						end
					end

					break
				end
			end

			LOG("1150")
			if vehicleTargetsReached==getn(vehicles) then
				LOG("1152")
				println("all vehicles reached their targets")
				LOG("ALL CD DESTROYERS REACHED THE TARGET")
				trigger:Deactivate()
			end

		</script>
	</trigger>

	<trigger Name="CITTorpedoBoatsFormationManager" active="0">
		<event eventid="GE_TARGET_REACHED" ObjName="ThePendulum" />
		<script>
			local CITTB01a = getObj("CITTorpedoBoat01_vehicle_0")
			local CITTB02a = getObj("CITTorpedoBoat02_vehicle_0")
			local CITTB03a = getObj("CITTorpedoBoat03_vehicle_0")
			local CITTB04a = getObj("CITTorpedoBoat04_vehicle_0")

			if CITTB01a or CITTB02a or CITTB03a or CITTB04a then
				if CITTB01a then
					CITTB01a:SetCruisingSpeed(20)
				end

				if CITTB02a then
					CITTB02a:SetCruisingSpeed(20)
				end

				if CITTB03a then
					CITTB03a:SetCruisingSpeed(20)
				end

				if CITTB04a then
					CITTB04a:SetCruisingSpeed(20)
				end
			else
				LOG("CIT TORPEDO BOAT FORMATION MANAGER DISABLED BY ITSELF")

				trigger:Deactivate()
			end

		</script>
	</trigger>

	<trigger Name="CITDestroyersFormationManager" active="0">
		<event eventid="GE_TARGET_REACHED" ObjName="ThePendulum" />
		<script>
			local CITD01a = getObj("CITDestroyer01_vehicle_0")
			local CITD02a = getObj("CITDestroyer02_vehicle_0")
			local CITD03a = getObj("CITDestroyer03_vehicle_0")
			local CITD04a = getObj("CITDestroyer04_vehicle_0")

			if CITD01a or CITD02a or CITD03a or CITD04a then
				if CITD01a then
					CITD01a:SetCruisingSpeed(4)
				end

				if CITD02a then
					CITD02a:SetCruisingSpeed(4)
				end

				if CITD03a then
					CITD03a:SetCruisingSpeed(4)
				end

				if CITD04a then
					CITD04a:SetCruisingSpeed(4)
				end
			else
				LOG("CIT DESTROYER FORMATION MANAGER DISABLED BY ITSELF")

				trigger:Deactivate()
			end

		</script>
	</trigger>

	<trigger Name="CITCruisersFormationManager" active="0">
		<event eventid="GE_TARGET_REACHED" ObjName="ThePendulum" />
		<script>
			local CITOC01a = getObj("CITOldCruiser01_vehicle_0")
			local CITD05a = getObj("CITDestroyer05_vehicle_0")
			local CITOC02a = getObj("CITOldCruiser02_vehicle_0")
			local CITOC03a = getObj("CITOldCruiser03_vehicle_0")

			if CITOC01a or CITD05a or CITOC02a or CITOC03a then
				if CITOC01a then
					CITOC01a:SetCruisingSpeed(7)
				end

				if CITD05a then
					CITD05a:SetCruisingSpeed(7)
				end

				if CITOC02a then
					CITOC02a:SetCruisingSpeed(7)
				end

				if CITOC03a then
					CITOC03a:SetCruisingSpeed(7)
				end
			else
				LOG("CIT CRUISER FORMATION MANAGER DISABLED BY ITSELF")

				trigger:Deactivate()
			end

		</script>
	</trigger>

	<trigger Name="CITTorpedoBoatsDestroyed" active="0">
		<event eventid="GE_TARGET_REACHED" ObjName="ThePendulum" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITTorpedoBoat01_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITTorpedoBoat02_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITTorpedoBoat03_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITTorpedoBoat04_vehicle_0" />
		<script>
			local AllEnemies = StringToTable(GetVar("Enemies").AsString)
			local Enemies = {AllEnemies[5],AllEnemies[6],AllEnemies[7],AllEnemies[8]}

			if CheckUnits(Enemies, "dead", 4) then
				UpdateUnitsStats()
				LOG("TORPEDO BOATS KILLED")

				CompleteQuest("CD_PH01_DestroyBoats")

				TDeactivate("CITTorpedoBoatsFormationManager")

				trigger:Deactivate()
			else
				UpdateQuestCoordinates("CD_PH01_DestroyBoats", Enemies)
			end
			
		</script>
	</trigger>

	<trigger Name="CITDestroyersDestroyed" active="0">
		<event eventid="GE_TARGET_REACHED" ObjName="ThePendulum" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITDestroyer01_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITDestroyer02_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITDestroyer03_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITDestroyer04_vehicle_0" />
		<script>
			local AllEnemies = StringToTable(GetVar("Enemies").AsString)
			local Enemies = {AllEnemies[1],AllEnemies[2],AllEnemies[3],AllEnemies[4]}

			if CheckUnits(Enemies, "dead", 4) then
				UpdateUnitsStats()
				LOG("DESTROYERS KILLED")

				CompleteQuest("CD_PH01_DestroyDestroyers")

				TDeactivate("CITDestroyersFormationManager")

				trigger:Deactivate()
			else
				UpdateQuestCoordinates("CD_PH01_DestroyDestroyers", Enemies)
			end
			
		</script>
	</trigger>

	<trigger Name="CITCoastalGunsDestroyed" active="0">
		<event eventid="GE_TARGET_REACHED" ObjName="ThePendulum" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITCoastalGun01" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITCoastalGun02" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITCoastalGun03" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITCoastalGun04" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITAAGun01" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITAAGun02" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITAAGun03" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITAAGun04" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITAAGun05" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITAAGun06" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITLav01_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITLav02_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITLav03_vehicle_0" />
		<script>
			local AllEnemies = StringToTable(GetVar("Enemies").AsString)
			local Enemies = {AllEnemies[14],AllEnemies[15],AllEnemies[16],AllEnemies[27],AllEnemies[28],AllEnemies[29],AllEnemies[30],AllEnemies[31],AllEnemies[32],AllEnemies[33],AllEnemies[34],AllEnemies[35],AllEnemies[36]}

			if CheckUnits(Enemies, "dead", 13) then
				UpdateUnitsStats()
				LOG("COASTAL GUNS KILLED")

				CompleteQuest("CD_PH01_DestroyTurrets")

				trigger:Deactivate()
			else
				UpdateQuestCoordinates("CD_PH01_DestroyTurrets", Enemies)
			end
			
		</script>
	</trigger>

	<trigger Name="CITOldCruisersDestroyed" active="0">
		<event eventid="GE_TARGET_REACHED" ObjName="ThePendulum" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITOldCruiser01_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITDestroyer05_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITOldCruiser02_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITOldCruiser03_vehicle_0" />
		<script>
			local AllEnemies = StringToTable(GetVar("Enemies").AsString)
			local Enemies = {AllEnemies[19],AllEnemies[20],AllEnemies[21],AllEnemies[22]}

			if CheckUnits(Enemies, "dead", 4) then
				UpdateUnitsStats()
				LOG("CRUISERS KILLED")

				CompleteQuest("CD_PH01_DestroyCruisers")

				TDeactivate("CITCruisersFormationManager")

				trigger:Deactivate()
			else
				UpdateQuestCoordinates("CD_PH01_DestroyCruisers", Enemies)
			end
			
		</script>
	</trigger>

	<trigger Name="CITTorpedoBoatsOrder" active="0">
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITTorpedoBoat01_vehicle_0" />
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITTorpedoBoat02_vehicle_0" />
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITTorpedoBoat03_vehicle_0" />
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITTorpedoBoat04_vehicle_0" />
		<event eventid="GE_UNDER_ATTACK" ObjName="CITTorpedoBoat01_vehicle_0" />
		<event eventid="GE_UNDER_ATTACK" ObjName="CITTorpedoBoat02_vehicle_0" />
		<event eventid="GE_UNDER_ATTACK" ObjName="CITTorpedoBoat03_vehicle_0" />
		<event eventid="GE_UNDER_ATTACK" ObjName="CITTorpedoBoat04_vehicle_0" />
		<script>
			local AllEnemies = StringToTable(GetVar("Enemies").AsString)
			LOG("boats order 1")
			local Enemies = {AllEnemies[5],AllEnemies[6],AllEnemies[7],AllEnemies[8]}
			LOG("boats order 2")
			UpdateQuestCoordinates("CD_PH01_DestroyBoats", Enemies)
			LOG("boats order 3")

			UpdateUnitsStats()
			LOG("boats order 4")

			AddImportantFadingMsgByStrIdFormatted("fm_cd_ph01_boats")
			LOG("KILL TORPEDO BOATS")

			TakeQuest("CD_PH01_DestroyBoats")

			SetVar("MissionStage", 1)

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="CITDestroyersOrder" active="0">
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITDestroyer01_vehicle_0" />
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITDestroyer02_vehicle_0" />
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITDestroyer03_vehicle_0" />
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITDestroyer04_vehicle_0" />
		<event eventid="GE_UNDER_ATTACK" ObjName="CITDestroyer01_vehicle_0" />
		<event eventid="GE_UNDER_ATTACK" ObjName="CITDestroyer02_vehicle_0" />
		<event eventid="GE_UNDER_ATTACK" ObjName="CITDestroyer03_vehicle_0" />
		<event eventid="GE_UNDER_ATTACK" ObjName="CITDestroyer04_vehicle_0" />
		<script>
			local AllEnemies = StringToTable(GetVar("Enemies").AsString)
			local Enemies = {AllEnemies[1],AllEnemies[2],AllEnemies[3],AllEnemies[4]}
			UpdateQuestCoordinates("CD_PH01_DestroyDestroyers", Enemies)
			
			UpdateUnitsStats()

			TDeactivate("CITDestroyersFormationManager")

			local CITD01a = getObj(AllEnemies[1])
			local CITD02a = getObj(AllEnemies[2])
			local CITD03a = getObj(AllEnemies[3])
			local CITD04a = getObj(AllEnemies[4])

			if CITD01a then
				CITD01a:SetCruisingSpeed(15)
				CITD01a:SetExternalPathByName("CITTorpedoBoat04_Waypoint1")
			end

			if CITD02a then
				CITD02a:SetCruisingSpeed(15)
				CITD01a:SetExternalPathByName("CITTorpedoBoat02_Waypoint1")
			end

			if CITD03a then
				CITD03a:SetCruisingSpeed(15)
				CITD01a:SetExternalPathByName("CITTorpedoBoat01_Waypoint1")
			end

			if CITD04a then
				CITD04a:SetCruisingSpeed(15)
				CITD01a:SetExternalPathByName("StartPath_Player")
			end

			AddImportantFadingMsgByStrIdFormatted("fm_cd_ph01_destroyers")
			LOG("KILL DESTROYERS")

			TakeQuest("CD_PH01_DestroyDestroyers")

			SetVar("MissionStage", 2)

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="CITCoastalGunsOrder" active="0">
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITCoastalGun01" />
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITCoastalGun02" />
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITCoastalGun03" />
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITCoastalGun04" />
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITLav01_vehicle_0" />
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITLav02_vehicle_0" />
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITLav03_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITLav01_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITLav02_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITLav03_vehicle_0" />
		<script>
			local AllEnemies = StringToTable(GetVar("Enemies").AsString)
			local Enemies = {AllEnemies[14],AllEnemies[15],AllEnemies[16],AllEnemies[27],AllEnemies[28],AllEnemies[29],AllEnemies[30],AllEnemies[31],AllEnemies[32],AllEnemies[33],AllEnemies[34],AllEnemies[35],AllEnemies[36]}
			UpdateQuestCoordinates("CD_PH01_DestroyTurrets", Enemies)

			UpdateUnitsStats()

			AddImportantFadingMsgByStrIdFormatted("fm_cd_ph01_garrison")
			LOG("KILL COASTAL GUNS")

			SetVar("MissionStage", 2)
			SetVar("CDDestroyer01WaypointStatus", TableToString({1, 2, 0}))
			SetVar("CDDestroyer02WaypointStatus", TableToString({1, 2, 0}))

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="CITOldCruisersOrder" active="0">
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITOldCruiser01_vehicle_0" />
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITDestroyer05_vehicle_0" />
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITOldCruiser02_vehicle_0" />
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITOldCruiser03_vehicle_0" />
		<script>
			local AllEnemies = StringToTable(GetVar("Enemies").AsString)
			local Enemies = {AllEnemies[19],AllEnemies[20],AllEnemies[21],AllEnemies[22]}
			UpdateQuestCoordinates("CD_PH01_DestroyCruisers", Enemies)

			UpdateUnitsStats()

			AddImportantFadingMsgByStrIdFormatted("fm_cd_ph01_cruisers")
			LOG("KILL CRUISERS")

			TakeQuest("CD_PH01_DestroyCruisers")

			SetVar("MissionStage", 4)

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="CITHelicoptersOrder" active="0">
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITHelicopter01_vehicle_0" />
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITHelicopter02_vehicle_0" />
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITHelicopter03_vehicle_0" />
		<event eventid="GE_NOTICE_ENEMY" ObjName="CITHelicopter04_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITCoastalGun01" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITCoastalGun02" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITCoastalGun03" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITCoastalGun04" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITAAGun01" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITAAGun02" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITAAGun03" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITAAGun04" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITAAGun05" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITAAGun06" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITLav01_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITLav02_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITLav03_vehicle_0" />
		<script>
			local AllEnemies = StringToTable(GetVar("Enemies").AsString)
			local Enemies = {AllEnemies[14],AllEnemies[15],AllEnemies[16],AllEnemies[27],AllEnemies[28],AllEnemies[29],AllEnemies[30],AllEnemies[31],AllEnemies[32],AllEnemies[33],AllEnemies[34],AllEnemies[35],AllEnemies[36]}

			if CheckUnits(Enemies, "dead", 5) then
				UpdateUnitsStats()

				local CITH01 = getObj("CITHelicopter01")
				local CITH02 = getObj("CITHelicopter02")
				local CITH03 = getObj("CITHelicopter03")
				local CITH04 = getObj("CITHelicopter04")

				if CITH01 then
					CITH01:SetProperty ("TeamTacticPrototype", "CautiousTactic")
					CITH01:_AdjustBehaviour ()
				end

				if CITH02 then
					CITH02:SetProperty ("TeamTacticPrototype", "CautiousTactic")
					CITH02:_AdjustBehaviour ()
				end

				if CITH03 then
					CITH03:SetProperty ("TeamTacticPrototype", "CautiousTactic")
					CITH03:_AdjustBehaviour ()
				end

				if CITH04 then
					CITH04:SetProperty ("TeamTacticPrototype", "CautiousTactic")
					CITH04:_AdjustBehaviour ()
				end

				local CITH01a = getObj("CITHelicopter01_vehicle_0")
				local CITH02a = getObj("CITHelicopter02_vehicle_0")
				local CITH03a = getObj("CITHelicopter03_vehicle_0")
				local CITH04a = getObj("CITHelicopter04_vehicle_0")

				if CITH01a then
					CITH01a:SetCruisingSpeed(20)
					CITH01a:SetExternalPathByName("CITHelicopter01_Waypoint1")
					CITH01a:SetCanBeDistractedFromMoving(true)
				end

				if CITH02a then
					CITH02a:SetCruisingSpeed(20)
					CITH02a:SetExternalPathByName("CITHelicopter02_Waypoint1")
					CITH02a:SetCanBeDistractedFromMoving(true)
				end

				if CITH03a then
					CITH03a:SetCruisingSpeed(20)
					CITH03a:SetExternalPathByName("CITHelicopter03_Waypoint1")
					CITH03a:SetCanBeDistractedFromMoving(true)
				end

				if CITH04a then
					CITH04a:SetCruisingSpeed(20)
					CITH04a:SetExternalPathByName("CITHelicopter04_Waypoint1")
					CITH04a:SetCanBeDistractedFromMoving(true)
				end

				AddFadingMsgId("fm_aircraft_enroute_foe")
				AddImportantFadingMsgByStrIdFormatted("fm_cd_ph01_helicopters")
				LOG("HELICOPTERS INBOUND")

				trigger:Deactivate()
			end

		</script>
	</trigger>

	<trigger Name="CITReinforcements" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="CITDestroyer01_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITDestroyer02_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITDestroyer03_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITDestroyer04_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITHelicopter01_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITHelicopter02_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITHelicopter03_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITHelicopter04_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITCoastalGun01" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITCoastalGun02" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITCoastalGun03" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITCoastalGun04" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITAAGun01" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITAAGun02" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITAAGun03" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITAAGun04" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITAAGun05" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITAAGun06" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITLav01_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITLav02_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="CITLav03_vehicle_0" />
		<script>
			local AllEnemies = StringToTable(GetVar("Enemies").AsString)
			local Enemies = {AllEnemies[1],AllEnemies[2],AllEnemies[3],AllEnemies[4],AllEnemies[14],AllEnemies[15],AllEnemies[16],AllEnemies[23],AllEnemies[24],AllEnemies[25],AllEnemies[26],AllEnemies[27],AllEnemies[28],AllEnemies[29],AllEnemies[30],AllEnemies[31],AllEnemies[32],AllEnemies[33],AllEnemies[34],AllEnemies[35],AllEnemies[36]}

			if CheckUnits(Enemies, "dead", 19) then
				UpdateUnitsStats()

				local CITOC01 = getObj("CITOldCruiser01")
				local CITD05 = getObj("CITDestroyer05")
				local CITOC02 = getObj("CITOldCruiser02")
				local CITOC03 = getObj("CITOldCruiser03")

				if CITOC01 then
					CITOC01:SetProperty ("TeamTacticPrototype", "BoxTactic")
					CITOC01:_AdjustBehaviour ()
				end

				if CITD05 then
					CITD05:SetProperty ("TeamTacticPrototype", "BoxTactic")
					CITD05:_AdjustBehaviour ()
				end

				if CITOC02 then
					CITOC02:SetProperty ("TeamTacticPrototype", "StandardTactic")
					CITOC02:_AdjustBehaviour ()
				end

				if CITOC03 then
					CITOC03:SetProperty ("TeamTacticPrototype", "CautiousTactic")
					CITOC03:_AdjustBehaviour ()
				end

				local CITOC01a = getObj("CITOldCruiser01_vehicle_0")
				local CITD05a = getObj("CITDestroyer05_vehicle_0")
				local CITOC02a = getObj("CITOldCruiser02_vehicle_0")
				local CITOC03a = getObj("CITOldCruiser03_vehicle_0")

				if CITOC01a then
					CITOC01a:SetCruisingSpeed(4)
					CITOC01a:SetExternalPathByName("CITOldCruiser01_Waypoint1")
					CITOC01a:SetCanBeDistractedFromMoving(true)
				end

				if CITD05a then
					CITD05a:SetCruisingSpeed(4)
					CITD05a:SetExternalPathByName("CITDestroyer05_Waypoint1")
					CITD05a:SetCanBeDistractedFromMoving(true)
				end

				if CITOC02a then
					CITOC02a:SetCruisingSpeed(4)
					CITOC02a:SetExternalPathByName("CITOldCruiser02_Waypoint1")
					CITOC02a:SetCanBeDistractedFromMoving(true)
				end

				if CITOC03a then
					CITOC03a:SetCruisingSpeed(4)
					CITOC03a:SetExternalPathByName("CITOldCruiser03_Waypoint1")
					CITOC03a:SetCanBeDistractedFromMoving(true)
				end

				AddFadingMsgId("fm_reinforcements_inbound_foe")
				LOG("ENEMY REINFORCEMENTS INBOUND")

				TActivate("CITCruisersFormationManager")

				trigger:Deactivate()
			end

		</script>
	</trigger>
</triggers>